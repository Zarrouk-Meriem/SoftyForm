import { appConfig } from '../config/app.js';
/**
 * Search data
 */
export const searchIndex = {};
/**
 * Update search index
 */
export function updateSearchIndex(prefixes, iconSets) {
    if (!appConfig.enableIconLists || !appConfig.enableSearchEngine) {
        // Search engine is disabled
        delete searchIndex.data;
        return;
    }
    // Parse all icon sets
    const sortedPrefixes = [];
    const keywords = Object.create(null);
    for (let i = 0; i < prefixes.length; i++) {
        const prefix = prefixes[i];
        const iconSet = iconSets[prefix]?.item;
        if (!iconSet) {
            continue;
        }
        const iconSetKeywords = iconSet.icons.keywords;
        if (!iconSetKeywords) {
            continue;
        }
        sortedPrefixes.push(prefix);
        for (const keyword in iconSetKeywords) {
            (keywords[keyword] || (keywords[keyword] = new Set())).add(prefix);
        }
    }
    // Set data
    return (searchIndex.data = {
        sortedPrefixes,
        keywords,
        partialCleanup: Date.now(),
    });
}
